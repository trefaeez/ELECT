# توثيق مشروع نظام إدارة شبكة الطاقة الكهربائية

## نظرة عامة
هذا النظام يساعد المستخدمين على إدارة وتصميم شبكات الطاقة الكهربائية من خلال تتبع مكونات مختلفة مثل مصادر الطاقة، اللوحات، قواطع الدارة، والأحمال.

## النماذج (Models)

### نموذج CircuitBreaker (قاطع الدارة)
نموذج موحد للقواطع يمكن أن يكون قاطع رئيسي أو قاطع توزيع.
يحتوي على حقول:
- `name` - اسم القاطع
- `model` - موديل القاطع
- `manufacturer` - الشركة المصنعة
- `breaker_type` - نوع القاطع (MCB, MCCB, ACB, ELCB, RCD, RCBO)
- `breaker_role` - دور القاطع (رئيسي أو توزيع)
- `number_of_poles` - عدد الأقطاب (1, 2, 3, 4)
- `rated_current` - التيار المقنن بالأمبير
- `short_circuit_current` - تيار القصر (Isc) بالكيلو أمبير
- `trip_curve` - منحنى الفصل (B, C, D, K)
- `label` - وصف مختصر للقاطع
- `position` - الموقع في اللوحة (الترتيب)

### نموذج PowerSource (مصدر الطاقة)
يحتوي على حقول:
- `name` - اسم المصدر
- `source_type` - نوع المصدر (الشبكة المحلية، مولد)
- `voltage` - الجهد الكهربائي (11KV, 380V, 220V, 24V)
- `total_ampacity` - الأمبير الكلي
- حقول الكابلات: `cable_quantity`, `cable_cross_section`, `neutral_cross_section`, `cable_material`, `cable_length`, `cable_path`
- `main_breaker` - القاطع الرئيسي (علاقة مع CircuitBreaker)

### نموذج Panel (اللوحة الكهربائية)
نموذج موحد للوحات الكهربائية يمكن أن تكون لوحة رئيسية أو لوحة فرعية.
يحتوي على حقول:
- `name` - اسم اللوحة
- `panel_type` - نوع اللوحة (رئيسية أو فرعية)
- `power_source` - مصدر الطاقة المغذي (في حالة اللوحة الرئيسية)
- `parent_panel` - اللوحة الأم المغذية (في حالة اللوحة الفرعية)
- `feeder_breaker` - القاطع المغذي للوحة في اللوحة الأم (في حالة اللوحة الفرعية)
- `voltage` - الجهد الكهربائي
- `ampacity` - الأمبير الكلي
- `main_breaker` - القاطع الرئيسي للوحة (علاقة مع CircuitBreaker)
- حقول الكابلات: `cable_quantity`, `cable_cross_section`, `neutral_cross_section`, `cable_material`, `cable_length`, `cable_path`
- `breakers` - القواطع المتصلة باللوحة (علاقة متعددة مع CircuitBreaker)

### نموذج PanelBreaker (الربط بين اللوحة والقاطع)
يحتوي على حقول:
- `panel` - اللوحة المرتبطة
- `breaker` - القاطع المرتبط

### نموذج Load (الحمل الكهربائي)
يحتوي على حقول:
- `name` - اسم الحمل
- `panel` - اللوحة المغذية للحمل
- `breaker` - القاطع المغذي للحمل
- `voltage` - الجهد الكهربائي
- `ampacity` - الأمبير الكلي
- حقول الكابلات: `cable_quantity`, `cable_cross_section`, `neutral_cross_section`, `cable_material`, `cable_length`, `cable_path`
- `power_consumption` - استهلاك الطاقة بالواط

## وظائف خاصة في النماذج

### CircuitBreaker
- تخصيص دور القاطع (رئيسي أو توزيع)
- ترتيب القواطع في اللوحة

### Panel
- التحقق تلقائياً من صحة العلاقات بناء على نوع اللوحة (رئيسية أو فرعية)
- ضبط الجهد تلقائياً من المصدر أو اللوحة الأم
- التأكد من أن القاطع الرئيسي محدد بشكل صحيح

### Load
- حساب المسار الكامل من المصدر إلى الحمل
- ضبط الجهد تلقائياً من اللوحة المغذية
- التأكد من أن القاطع المحدد ينتمي للوحة المغذية

## واجهات API

### مصادر الطاقة (PowerSource)
- عرض جميع مصادر الطاقة (GET /api/powersources/)
- عرض مصدر طاقة محدد (GET /api/powersources/{id}/)
- إضافة مصدر طاقة جديد (POST /api/powersources/)
- تعديل مصدر طاقة (PUT /api/powersources/{id}/)
- حذف مصدر طاقة (DELETE /api/powersources/{id}/)

### اللوحات الكهربائية (Panel)
- عرض جميع اللوحات (GET /api/panels/)
- عرض لوحة محددة (GET /api/panels/{id}/)
- إضافة لوحة جديدة (POST /api/panels/)
- تعديل لوحة (PUT /api/panels/{id}/)
- حذف لوحة (DELETE /api/panels/{id}/)

### قواطع الدارة (CircuitBreaker)
- عرض جميع قواطع الدارة (GET /api/circuitbreakers/)
- عرض قاطع دارة محدد (GET /api/circuitbreakers/{id}/)
- إضافة قاطع دارة جديد (POST /api/circuitbreakers/)
- تعديل قاطع دارة (PUT /api/circuitbreakers/{id}/)
- حذف قاطع دارة (DELETE /api/circuitbreakers/{id}/)

### ربط اللوحات بالقواطع (PanelBreaker)
- عرض جميع ربطات اللوحات بالقواطع (GET /api/panelbreakers/)
- عرض ربط محدد (GET /api/panelbreakers/{id}/)
- إضافة ربط جديد (POST /api/panelbreakers/)
- تعديل ربط (PUT /api/panelbreakers/{id}/)
- حذف ربط (DELETE /api/panelbreakers/{id}/)

### الأحمال الكهربائية (Load)
- عرض جميع الأحمال (GET /api/loads/)
- عرض حمل محدد (GET /api/loads/{id}/)
- إضافة حمل جديد (POST /api/loads/)
- تعديل حمل (PUT /api/loads/{id}/)
- حذف حمل (DELETE /api/loads/{id}/)

## العلاقات بين المكونات المختلفة

1. **مصدر الطاقة (PowerSource)**
   - يمكن أن يغذي عدة لوحات رئيسية (Panel ذات نوع "رئيسية")
   - يحتوي على قاطع رئيسي (CircuitBreaker)

2. **اللوحة (Panel)**
   - إذا كانت لوحة رئيسية:
     - تتغذى من مصدر طاقة واحد (PowerSource)
     - تحتوي على قاطع رئيسي (CircuitBreaker ذو دور "رئيسي")
     - تحتوي على عدة قواطع توزيع (CircuitBreaker ذو دور "توزيع")
     - يمكن أن تغذي عدة لوحات فرعية
     - يمكن أن تغذي أحمال مباشرة (Load)
   - إذا كانت لوحة فرعية:
     - تتغذى من لوحة أم (Panel) عبر قاطع (CircuitBreaker)
     - تحتوي على قاطع رئيسي (CircuitBreaker ذو دور "رئيسي")
     - تحتوي على عدة قواطع توزيع (CircuitBreaker ذو دور "توزيع")
     - تغذي عدة أحمال (Load)

3. **القاطع (CircuitBreaker)**
   - يمكن أن يكون قاطع رئيسي لمصدر طاقة أو لوحة
   - يمكن أن يكون قاطع توزيع في لوحة
   - يمكن أن يغذي لوحة فرعية أو حمل

4. **الحمل (Load)**
   - يتغذى من لوحة عبر قاطع محدد

## الميزات الإضافية
- آلية التحقق التلقائية للعلاقات (مثل التأكد من أن اللوحة الفرعية تتغذى من لوحة أم)
- ضبط تلقائي للقيم المشتقة (مثل الجهد من المصدر أو اللوحة الأم)
- تأكد تلقائي من أن القاطع الرئيسي له دور "رئيسي"
- إمكانية إضافة لوحات وقواطع وأحمال بشكل سهل ومتكامل

## الصفحة الرئيسية
عنوان الصفحة الرئيسية للتطبيق هو: `/`
صفحة واجهة API الرئيسية: `/api/`